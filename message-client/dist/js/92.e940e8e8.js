"use strict";(self["webpackChunkmessage_client"]=self["webpackChunkmessage_client"]||[]).push([[92],{7627:function(e,a,t){t.d(a,{h:function(){return i}});var s=t(1020),l=t(1296),r=t(2074);const i=(0,s.Q_)("main",{state:()=>({user:{id:0,userId:0,name:"",email:"",role:"",avatar:"",brief:"",sex:3,birthday:""},token:localStorage.getItem("token")||"",type:0,isExist:!1}),actions:{async initUser(){let e=await(0,l.n5)();200==e.status&&(this.user.id=e.data.ip)},async getInfo(){let e=await(0,l.bG)(),{name:a,userId:t,email:s,role:r,avatar:i,brief:n,sex:u,birthday:o}=e.data;200==e.status&&(this.user.userId=t,this.user.name=a,this.user.email=s,this.user.role=r,this.user.avatar=i,this.user.brief=n,this.user.sex=u,this.user.birthday=o),localStorage.setItem("userInfo",JSON.stringify(this.user))},async login(e){let a=await(0,l.n$)(e);localStorage.setItem("token",a.token),this.getInfo(),r.ZP.success(a.msg)},async submitInfo(e){let a=await(0,l.gS)(e);200===a.status&&(this.user=e,localStorage.setItem("userInfo",JSON.stringify(this.user)),r.ZP.success(a.msg))},async isRegister(e){this.isExist=await(0,l.J)(e)},logOut(){localStorage.removeItem("userInfo"),localStorage.removeItem("token")}},getters:{}})},7092:function(e,a,t){t.r(a),t.d(a,{default:function(){return _}});t(7658);var s=t(3396),l=t(4870),r=t(5522),i=t(1296),n=t(7627),u=t(1020),o=t(2074),c=t(3824);const d={class:"content"},m=(0,s._)("div",{class:"header"},[(0,s._)("img",{src:r,alt:""}),(0,s._)("span",null,"轻语留言")],-1),g={class:"card"},p=(0,s._)("div",{class:"title"},[(0,s._)("span",null,"修改密码"),(0,s._)("p",null,"请输入账号注册邮箱获取验证码")],-1),f={class:"info"},h=(0,s._)("p",{class:"footer"},"该注册账号只限于在网站内测试、学习，请妥善保护自己个人隐私和个人信息，以免造成不必要的影响。谢谢～",-1);var v=(0,s.aZ)({__name:"Repsw",setup(e){const a=(0,n.h)();let{isExist:t}=(0,u.Jk)(a),r=(0,l.qj)({email:"",code:"",password:""}),v=async(e,s)=>{if(0===s.length)return Promise.reject("邮箱不能为空");let l=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return l.test(s)?(await a.isRegister({email:s}),t.value?void 0:Promise.reject("该邮箱未注册账号")):Promise.reject("请输入正确的邮箱")},w=async(e,a)=>{if(0===a.length)return Promise.reject("请填入验证码");let t={email:r.email,code:r.code},s=await(0,i.VP)(t);return!s.check||a.length<6?Promise.reject("验证码错误"):void 0},_=async(e,a)=>0===a.length?Promise.reject("密码不能为空"):a.length<6?Promise.reject("密码不能小于六位"):void 0;const y=[{required:!0,validator:v}],b=[{validator:w}],k=[{required:!0,validator:_,trigger:"change"}],S=(0,l.iH)(),I=()=>{S.value?.validate().then((async e=>{let t=await(0,i.ZU)(e);200===t.status&&(a.logOut(),o.ZP.success(t.msg),c.Z.push("/"))})).catch((()=>{}))},U=async()=>{let e={email:r.email},a=await(0,i.Cq)(e);console.log("res",a)};return(e,a)=>{const t=(0,s.up)("a-input"),i=(0,s.up)("a-form-item"),n=(0,s.up)("a-col"),u=(0,s.up)("a-button"),o=(0,s.up)("a-row"),c=(0,s.up)("a-input-password"),v=(0,s.up)("a-form"),w=(0,s.up)("a-card");return(0,s.wg)(),(0,s.iD)("div",d,[m,(0,s._)("div",g,[(0,s.Wm)(w,{style:{width:"390px"}},{default:(0,s.w5)((()=>[p,(0,s._)("div",f,[(0,s.Wm)(v,{layout:"vertical",model:(0,l.SU)(r),ref_key:"formRef",ref:S},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{label:"邮箱",name:"email",rules:y,validateTrigger:"submit"},{default:(0,s.w5)((()=>[(0,s.Wm)(t,{size:"large",placeholder:"用户邮箱",value:(0,l.SU)(r).email,"onUpdate:value":a[0]||(a[0]=e=>(0,l.SU)(r).email=e)},null,8,["value"])])),_:1}),(0,s.Wm)(i,{label:"验证码",name:"code",rules:b,validateTrigger:"submit"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{gutter:24},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{span:10},{default:(0,s.w5)((()=>[(0,s.Wm)(t,{size:"large","validate-event":!1,value:(0,l.SU)(r).code,"onUpdate:value":a[1]||(a[1]=e=>(0,l.SU)(r).code=e)},null,8,["value"])])),_:1}),(0,s.Wm)(n,{span:14},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{size:"large",shape:"round",class:"send-btn",onClick:U},{default:(0,s.w5)((()=>[(0,s.Uk)("发送验证码")])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(i,{label:"新密码",name:"password",rules:k},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{value:(0,l.SU)(r).password,"onUpdate:value":a[2]||(a[2]=e=>(0,l.SU)(r).password=e),size:"large",placeholder:"不小于6位数"},null,8,["value"])])),_:1}),(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{type:"primary",shape:"round",class:"btn",onClick:I},{default:(0,s.w5)((()=>[(0,s.Uk)("修改")])),_:1})])),_:1})])),_:1},8,["model"])])])),_:1})]),h])}}});const w=v;var _=w},5522:function(e,a,t){e.exports=t.p+"img/logo.779a3991.svg"}}]);
//# sourceMappingURL=92.e940e8e8.js.map